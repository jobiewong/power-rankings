<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Power Rankings</title>
    <link rel="stylesheet" href="index.css" />
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,900;1,100;1,300;1,400;1,500;1,900&display=swap');
      </style> 
  </head>
  <body>
      <div class="header-wrapper">
        <h1 class="title-name">Platchat Valorant</h1>
        <div class="divider"></div>
        <h2 class="title-power">Power Rankings</h2>
      </div>

      <div class="settings-container hidden">
        <div class="close-button" id="closebutton"><svg class="x-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-reactroot="">
          <path fill="#000" d="M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z" clip-rule="evenodd" fill-rule="evenodd" undefined="1"></path>
          <path fill="#000" d="M12 2C12.5523 2 13 2.44772 13 3V21C13 21.5523 12.5523 22 12 22C11.4477 22 11 21.5523 11 21V3C11 2.44772 11.4477 2 12 2Z" clip-rule="evenodd" fill-rule="evenodd" undefined="1"></path>
          </svg></div>
        <h1>Add Team</h1>
        <form class="team-form">
          <label>Team Name</label>
          <input type="text" id="tname" name="teamname" placeholder="Team Name">
          <label>Text Colour</label>
          <input type="text" id="tcolour" name="textcolour" placeholder="#1111">
          <label>Background Colour</label>
          <input type="text" id="bcolour" name="bgcolur" placeholder="#FFF">
          <label>Team Logo</label>
          <input type="file" id="logofile" name="logo_file" class="file-input" accept=".jpg, .jpeg, .png">
          <input type="button" value="Submit">
        </form>
        <img id="outImage">
      </div>

      <div class="container">
        <div class="numbers">
          <div class="number-wrapper">1</div>
          <div class="number-wrapper">2</div>
          <div class="number-wrapper">3</div>
          <div class="number-wrapper">4</div>
          <div class="number-wrapper">5</div>
          <div class="number-wrapper">6</div>
          <div class="number-wrapper">7</div>
          <div class="number-wrapper">8</div>
          <div class="number-wrapper">9</div>
          <div class="number-wrapper">10</div>
        </div>

        <div class="wrapper lists" id="wrapperid" data-category="main">
          <div class="item">
            <div class="item-logo" style="background-image: url(https://i.imgur.com/7H0XB42.png)"></div>
            <div class="item-text"><span>Otpic Gaming</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>Cloud 9 Blue</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>The Guard</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>XSET</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>Faze</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>Version1</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>Sentinels</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>Knights</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>NRG</span></div>
          </div>
          <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>Luminosity</span></div>
          </div>
        </div>

        <div class="overflow-wrapper lists" id="overflowwrapper" data-category="overflow">
          <!-- <div class="item">
            <div class="item-logo"></div>
            <div class="item-text"><span>GenG</span></div>
          </div> -->
        </div>
      </div>

      <div class="add-button" id="addbutton" type="button"><svg class="plus-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-reactroot="">
        <path fill="#ffffff" d="M2 12C2 11.4477 2.44772 11 3 11H21C21.5523 11 22 11.4477 22 12C22 12.5523 21.5523 13 21 13H3C2.44772 13 2 12.5523 2 12Z" clip-rule="evenodd" fill-rule="evenodd" undefined="1"></path>
        <path fill="#ffffff" d="M12 2C12.5523 2 13 2.44772 13 3V21C13 21.5523 12.5523 22 12 22C11.4477 22 11 21.5523 11 21V3C11 2.44772 11.4477 2 12 2Z" clip-rule="evenodd" fill-rule="evenodd" undefined="1"></path>
        </svg></div>


<!-- SCRIPT TIME -->

      <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/lodash@4.17.21/lodash.min.js"></script>  

      <script>
        var localStorageAvailable = (typeof localStorage !== "undefined");

        function getValue(sortable) {
            var order = localStorage.getItem(sortable.options.category);
            return order ? order.split('|') : [];
        }

        function setValue(sortable) {
            var order = sortable.toArray();
            console.log(order);
            localStorage.setItem(sortable.options.category, order.join('|'));
        }

        function setupStore() {
            if (localStorageAvailable) {
                return {
                    get: getValue,
                    set: setValue
                };
            }
            return {}; 
        }

        function onAdd(evt) {
            setValue(this);
            console.log("set");
        }

        function applyState($section, categoryName) {
            if (localStorageAvailable) {
                var order = localStorage.getItem(categoryName);
                var itemIds = order ? order.split('|') : [];
                var $items = _.map(itemIds, function(itemId, index) {
                    return $("[data-id='" + itemId + "'");
                });
                $section.append($items);
            }
        }

        var options = {
          group: "listgroup",
          store: setupStore(),
          onAdd: onAdd,
          animation: 200
        }

        function init() {

          // applyState($(".wrapper"), "main");
          // applyState($(".overflow-wrapper"), "overflow");

        $(".lists").each(function(index, section) {
          var $section = $(section);
          var category = $section.attr("data-category");
          var sortableOptions = _.extend({}, options, { category: category });
          applyState($section, category);
          $section.data("twoColumnSortable", new Sortable(section, sortableOptions));
            });
        }

        init();

      </script>

      <script type="text/javascript">
        $("#addbutton").click(function () {
          $(".settings-container").removeClass('hidden');
          $(".settings-container").addClass('show');
        });

        $("#closebutton").click(function () {
          $(".settings-container").removeClass('show');
          $(".settings-container").addClass('hidden');
          });
      </script>

      <script>
          document.getElementById('logofile').addEventListener('change', readURL, true);
          function readURL(){
            var file = document.getElementById("logofile").files[0];
            var reader = new FileReader();
            reader.onloadend = function(){
                logoFile = "url(" + reader.result + ")";        
            }
            if(file){
                reader.readAsDataURL(file);
              }else{
              }
          }

          function addTeam(file) {
          var t_input = document.getElementById("tname"); 
          var teamname = t_input.value.trim(); 

          var c_input = document.getElementById("tcolour"); 
          var textcolour = c_input.value.trim(); 

          var bg_input = document.getElementById("bcolour"); 
          var backgroundcolour = bg_input.value.trim(); 
       
          const itemDiv = document.createElement("div");
          itemDiv.className = "item";
          const itemLogo = document.createElement("div");
          itemLogo.className = "item-logo";
          const itemText = document.createElement("div");
          itemText.className = "item-text";

          itemDiv.appendChild(itemLogo)
          itemDiv.appendChild(itemText)
          itemText.innerText = teamname;
          itemText.style.color = textcolour;
          itemDiv.style.backgroundColor = backgroundcolour;
          itemLogo.style.backgroundImage = file;

          document.getElementById("overflowwrapper").appendChild(itemDiv);

          $(".settings-container").removeClass('show');
          $(".settings-container").addClass('hidden');
        }

        var button = document.querySelector('input[type="button"]');
        button.addEventListener('click',function(){addTeam(logoFile)},false);
      </script>
  </body>
</html>